<%--**************** code added by Sudha Balakrishnan, May 2015, for visualizing coordinates ***************--%>		
<script type="text/javascript">
function VisualizeValues()
{
var x1 = document.getElementById("myForm").elements.namedItem("chan1X").value;
var y1 = document.getElementById("myForm").elements.namedItem("chan1Y").value;
var z1 = document.getElementById("myForm").elements.namedItem("chan1Z").value;

var x2 = document.getElementById("myForm").elements.namedItem("chan2X").value;
var y2 = document.getElementById("myForm").elements.namedItem("chan2Y").value;
var z2 = document.getElementById("myForm").elements.namedItem("chan2Z").value;

var x3 = document.getElementById("myForm").elements.namedItem("chan3X").value;
var y3 = document.getElementById("myForm").elements.namedItem("chan3Y").value;
var z3 = document.getElementById("myForm").elements.namedItem("chan3Z").value;

var x4 = document.getElementById("myForm").elements.namedItem("chan4X").value;
var y4 = document.getElementById("myForm").elements.namedItem("chan4Y").value;
var z4 = document.getElementById("myForm").elements.namedItem("chan4Z").value;

var urlwithcoord = "visualize.jsp?x1="+x1+"&y1="+y1+"&z1="+z1;
var urlwithcoord = urlwithcoord+"&x2="+x2+"&y2="+y2+"&z2="+z2;
var urlwithcoord = urlwithcoord+"&x3="+x3+"&y3="+y3+"&z3="+z3;
var urlwithcoord = urlwithcoord+"&x4="+x4+"&y4="+y4+"&z4="+z4;

window.open (urlwithcoord,"mywindow");
}
</script>
<%--*******************************************************************************************************--%>		

<jsp:useBean id="errs" scope="request" class="gov.fnal.elab.cosmic.beans.GeometryErrors" />
<e:useBean bean="${geoEntry}">
    <%@ include file="check-metadata.jspf" %>
	<c:choose>
		<c:when test="${param.commit == null || !geoEntry.valid || message != null }" >
		<form id="myForm" method="post">
		<e:trinput type="hidden" name="detectorID"/>
	
		<c:if test="${!nodate && !ro}">
			Date: <e:trselect name="month"
					valueList="1..12"
					labelList="January, February, March, April, May, June, July, August, September, October, November, December"/>
			/ <e:trselect name="day" valueList="01..31" labelList="01..31"/>
			/ <e:trselect name="year" valueList="1999..2020" labelList="1999..2020"/>
			@ <e:trselect name="hour" valueList="00..23" labelList="00..23"/>
			: <e:trselect name="minute" valueList="00..59" labelList="00..59"/>
			<a href="javascript:glossary('UTC')">UTC</a>
	 	</c:if>
		
		<div class="subtitle">Detector Configuration: -20 &#x2264 x &#x2264 20, -20 &#x2264 y &#x2264 20, -40 &#x2264 z &#x2264 40.  GPS is at (0,0,0).</div>
		<c:if test="${!ro}">
			Confused? Seeing errors? Please consult the <a href="tutorial.jsp">tutorial</a>.
		</c:if>
		
		<div id="channels">
			<table border="0" cellspacing="5" cellpadding="2">
                <tr>
                    <td>&nbsp;</td>
                    <th>Active<br />Channels:</th>
                    <c:forEach var="i" items="1,2,3,4">
                    	<td class="channel-id">${i}
                    	<e:trinput type="checkbox" name="chan${i}IsActive" disabled="${ro}"  
                        	onclick="HideShow('ch${i}-v');HideShow('ch${i}-h')"/></td>
                    </c:forEach>
                </tr>
                <tr id="secondary-heading">
                    <td>&nbsp;</td>
                    <td>Cable<br />Length<span class="unit"> (m)</span></td>
                    <td>Area <span class="unit">(cm<sup>2</sup>)</span></td>
                    <td>E-W <span class="unit">(m)</span></td>
                    <td>N-S <span class="unit">(m)</span></td>
                    <td>Up-Dn <span class="unit">(m)</span></td>
                </tr>
                <c:set var="v" value="visibility: visible; display:"/>
                <c:set var="h" value="visibility: hidden; display: none"/>
                <c:forEach var="i" items="1,2,3,4">
                	<c:set var="isChannelActive" value="chan${i}IsActive"/>
        			<tr id="ch${i}-v" style="${geoEntry[isChannelActive] ? v : h}">
	                    <td style="padding-right:5px"><img src="../graphics/geo_det${i}.gif"></td>
	                    <td><e:trinput disabled="${ro}" type="text" name="chan${i}CableLength" size="4"/></td>
	                    <td><e:trinput disabled="${ro}" type="text" name="chan${i}Area" size="6"/></td>
	                    <td><e:trinput disabled="${ro}" type="text" name="chan${i}X" size="5"/></td>
	                    <td><e:trinput disabled="${ro}" type="text" name="chan${i}Y" size="5"/></td>
	                    <td><e:trinput disabled="${ro}" type="text" name="chan${i}Z" size="5"/></td>
	                </tr>
	        		<tr id="ch${i}-h" style="${geoEntry[isChannelActive] ? h : v}">
	                    <td style="padding-right:5px"><img src="../graphics/geo_det${i}.gif"></td>
	                    <td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td>
	                </tr>
				</c:forEach>
			</table>
		</div>
		
		<div id="orientation">
            <table border="0">
                <tr>
                    <td>
                        <img src="../graphics/med_stacked.gif"><br />
                        <e:trradio name="stackedState" valueList="1" labelList="Stacked" disabled="${ro}" />
                    </td>
                    <td id="orientation-label">
                        Orientation
                    </td>
                    <td>
                        <img src="../graphics/med_unstacked.gif"><br />
                        <e:trradio name="stackedState" valueList="0" labelList="Unstacked" disabled="${ro}" />
                    </td>
                </tr>
            </table>
        </div>
        
<%--*************Code added by Sudha Balakrishnan, May 2015, for visualizing coordinates entered.**********--%>

		<p>
	    <a href="javascript:VisualizeValues()">Visualize values.</a>
		</p>   
		
<%--*******************************************************************************************************--%>		
		             
        <div class="subtitle">GPS Location</div>

		<div id="gps">
            <table border="0" cellspacing="3">
                <tr valign="top">
                    <td>
                        Latitude: <e:trinput type="text" name="latitude" size="15" disabled="${ro}" />
                        <br>
                        <c:if test="${!ro}">
                        	<span style="font-size: 90%">e.g., 47:39.234736 N</font>
                        </c:if>
                    </td>
                    <td>
                        Longitude: <e:trinput type="text" name="longitude" size="15" disabled="${ro}" />
                        <br>
                        <c:if test="${!ro}">
                        	<span style="font-size: 90%">e.g., 122:18.68 W</span>
                        </c:if>
                    </td>
                </tr>
                <tr valign="top">
                    <td>
                        Altitude (m): <e:trinput type="text" name="altitude" size="3" disabled="${ro}" />
                    </td>
                    <td>
                        GPS Cable Length (m): <e:trinput type="text" name="gpsCableLength" size="6" disabled="${ro}" />
                    </td>
                </tr>
            </table>
        </div>
        
        <c:if test="${!geoEntry.valid && !ro}">
        	<c:choose>
        		<c:when test="${!empty geoEntry.errors}">
        			<ul id="error-list">
        				<c:forEach var="err" items="${geoEntry.errors}">
        					<li>
        						<a class="invalid" style="font-size: 120%" href="../geometry/tutorial.jsp#${err}">
    	    						${errs.errors[err]}
	        					</a>
	        				</li>
        				</c:forEach>
        			</ul>
        		</c:when>
        		<c:otherwise>
        			<p class="invalid" style="font-size: 120%">Some fields are invalid and are highlighted in red</p>
        		</c:otherwise>
        	</c:choose>
        	<br /><br />
        </c:if>
        
        <c:if test="${!ro}">
        	<center>			    	
               	<c:if test="${message != null}" >
                	<p><font style="color: red;">${message} data file(s) will be affected by this change.
                    Are you sure you want to commit? <input type="checkbox" name="commitCheck" id="commitCheck" /> </p>
               	</c:if>  
            	<input type="submit" name="commit" value="Commit Geometry" >
			</center>
		</c:if>
		</form>
		</c:when>
		
		<c:otherwise>
			<%@ include file="commit.jspf" %>
		</c:otherwise>
	</c:choose>
</e:useBean>